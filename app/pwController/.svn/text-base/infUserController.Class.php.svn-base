<?php
class infUserController extends MwController {

	public function actionBeforDisplay(){
		$smarty = MwSmarty::getInstance();
		$user = MwUser::getFullList();
		$smarty->assign( 'user',$user );

	}
	
	
	public function actionSave(){
		
		$mode = $_POST['mode'];
		$id = $_POST['USR_ID'];
		if($mode=='N'){
			$id = '';
		}
		
		
		$obj = new MwUser($id);
		$obj->USR_LNAME = $_POST['USR_LNAME'];
		$obj->USR_FNAME = $_POST['USR_FNAME'];
		$obj->USR_LOGIN = $_POST['USR_LOGIN'];
		
		$obj->USR_MAIL = $_POST['USR_MAIL'];
		$obj->USR_RIGHTS = $_POST['USR_RIGHTS'];

		$obj->USR_ACTIVE = 1;

		if($mode=='E'){
			if($_POST['USR_PSW'] != ''){
				$obj->USR_PSW = md5($_POST['USR_PSW']);
			}
		}
		else{
			$obj->USR_PSW = md5($_POST['USR_PSW']);
		}
		
		$obj->save();
	}

	public function actionDelete(){
		$id = $_POST['usr_id'];
		$obj = new MwUser($id);
		$obj->delete();
		echo ($id);
	}
}